import InstallNuGet from './content/_install-nuget.mdx';
import CSharpMain from './content/_csharp-main.mdx';
import CSharpUpdates from './content/_csharp-updates.mdx';
import InstallVpk from './content/_install_vpk.mdx';
import BuildRelease from './content/_build_release.mdx';
import Completion from './content/_completion.mdx';
import Admonition from '@theme/Admonition';


# Getting Started: C# / WPF
<AppliesTo win />
Get started with .NET 5+ (cross-platform) or .NET Framework.

<InstallNuGet step={1}/>

<FancyStep step={2}>
    <details>
        <summary>
            <strong>Create a Main method</strong>
        </summary>

        Though it is possible to simply put the Velopack bootstrap call within `App.xaml.cs`, we recommend creating a custom `Main` method to avoid any WPF overhead when applying updates.

        First, change the Build Actio of `App.xaml` to `Page` (right-click the file in Solution Explorer, select Properties, and change the Build Action). 
        The project file should contain the following lines:
        ```xml
        <ItemGroup>
            <ApplicationDefinition Remove="App.xaml"/>
            <Page Include="App.xaml"/>
        </ItemGroup>
        ```

        While editing the project file, change the StartupObject to point to your `App` class.
        Add the following PropertyGroup to your `.csproj` file:
        ```xml
        <PropertyGroup>
            <StartupObject>YourNamespace.App</StartupObject>
        </PropertyGroup>
        ```

        Add a `Main` method to your `App.xaml.cs` file. It should look similar to this:
        ```csharp
        public partial class App : Application
        {
            [STAThread]
            private static void Main(string[] args)
            {
                App app = new();
                app.InitializeComponent();
                app.Run();
            }
            // The rest of your App.xaml.cs code goes here
        }
        ```

        Verify the changes by ensuring your app still starts correctly.
    </details>
</FancyStep>

<CSharpMain step={3}/>

<CSharpUpdates step={4}/>

<InstallVpk step={5}/>

<FancyStep step={6}>
    <details>
        <summary>
            <strong>Publish App</strong>
        </summary>

        Before building a Velopack release, you must first build your application and publish it to a directory.

        For simplicity, we recommend publishing it as a [self-contained application](https://learn.microsoft.com/en-us/dotnet/core/deploying/#publish-self-contained).

        ```batch
        dotnet publish yourApp.csproj -c Release --self-contained -r win-x64 -o .\publish
        ```
        <Admonition type="tip">
            Starting with .NET 7, the `-o`/`--output` option [can no longer be used with a solution file](https://learn.microsoft.com/en-us/dotnet/core/compatibility/sdk/7.0/solution-level-output-no-longer-valid?WT.mc_id=DT-MVP-5003472).
        
            Starting with .NET 8 and later, the `dotnet publish` command defaults to the Release configuration, so you can omit the `-c Release` option.
            For more details see https://learn.microsoft.com/en-us/dotnet/core/compatibility/sdk/8.0/dotnet-publish-config.
        
            If you execute the dotnet publish command from within the same directory as the .csproj file, you can omit the project argument. You can find more details on the [dotnet publish documentation](https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-publish?WT.mc_id=DT-MVP-5003472#arguments).
        </Admonition>
        
    </details>
</FancyStep>

<BuildRelease step={7}/>

<Completion />