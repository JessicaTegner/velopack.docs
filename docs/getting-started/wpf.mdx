import InstallNuGet from './content/_install-nuget.mdx';
import CSharpMain from './content/_csharp-main.mdx';
import CSharpUpdates from './content/_csharp-updates.mdx';
import InstallVpk from './content/_install-vpk.mdx';
import CSharpPublish from './content/_csharp-publish.mdx';
import BuildRelease from './content/_build-release.mdx';
import Completion from './content/_completion.mdx';

# Getting Started: C# / WPF
<AppliesTo win />
Get started with .NET 5+ (cross-platform) or .NET Framework.

<InstallNuGet step={1}/>

<FancyStep step={2}>
    <details>
        <summary>
            <strong>Create a Main method</strong>
        </summary>

        Though it is possible to simply put the Velopack bootstrap call within `App.xaml.cs`, we recommend creating a custom `Main` method to avoid any WPF overhead when applying updates.

        First, change the Build Actio of `App.xaml` to `Page` (right-click the file in Solution Explorer, select Properties, and change the Build Action). 
        The project file should contain the following lines:
        ```xml
        <ItemGroup>
            <ApplicationDefinition Remove="App.xaml"/>
            <Page Include="App.xaml"/>
        </ItemGroup>
        ```

        While editing the project file, change the StartupObject to point to your `App` class.
        Add the following PropertyGroup to your `.csproj` file:
        ```xml
        <PropertyGroup>
            <StartupObject>YourNamespace.App</StartupObject>
        </PropertyGroup>
        ```

        Add a `Main` method to your `App.xaml.cs` file. It should look similar to this:
        ```csharp
        public partial class App : Application
        {
            [STAThread]
            private static void Main(string[] args)
            {
                App app = new();
                app.InitializeComponent();
                app.Run();
            }
            // The rest of your App.xaml.cs code goes here
        }
        ```

        Verify the changes by ensuring your app still starts correctly.
    </details>
</FancyStep>

<CSharpMain step={3}/>

<CSharpUpdates step={4}/>

<InstallVpk step={5}/>

<CSharpPublish step={6}/>

<BuildRelease step={7}/>

<Completion />