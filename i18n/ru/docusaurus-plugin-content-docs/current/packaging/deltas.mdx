# Дельта-обновления

<AppliesTo all />
Дельта-обновления обеспечивают быстрые обновления даже для самых крупных приложений.

По умолчанию, пока в вашем каталоге `--outputDir`/`-o` есть предыдущая версия, Velopack автоматически генерирует дельту при создании новой версии.

:::tip
Если у вас нет последней локальной версии, например. вы работаете в CI, вы можете использовать команду vpk download для автоматического получения данных и создания дельта-файлов.
:::

Дельта-пакеты используют [Zstandard](https://github.com/facebook/zstd) для создания бинарных исправлений отдельных файлов в вашем пакете. Из-за ограничений Zstandard размер отдельного файла не может превышать 2 ГБ.

## Оптимизация размера

Параметры по умолчанию, выбранные для создания патчей, должны обеспечить хороший баланс размера и скорости. 
Если вы хотите оптимизировать размер, вы можете сделать это с помощью аргумента --delta BestSize.
YMMV, для некоторых приложений это может дать вам большую экономию, а для других — нет. В любом случае это будет намного медленнее, примерно на уровне алгоритма bsdiff.

## Как работает Дельта

Во время обновлений Velopack будет искать, возможно, более одной дельты для загрузки. Представьте, что вы опубликовали следующие выпуски:

- `1.0.0`
- `1.0.1`
- `1.0.2`
- `1.0.3`

Если пользователь какое-то время не открывал ваше приложение и у него установлено `1.0.0`, при следующем открытии приложения будут загружены 
3 дельты: `1.0.1-delta`, \`1.0 .2-дельта» и «1.0.3-дельта».

Ранее загруженный/установленный пакет хранится в `%LocalAppData\{packId}\packages`, поэтому Velopack затем последовательно применит эти 3 дельты 
поверх локального пакета, который существует в этом каталог. 

После применения изменений и восстановления версии 1.0.3 она будет готова к применению. 

В Velopack есть эвристика, которая пытается решить, лучше ли загрузить N delta или вместо этого загрузить последнюю полную версию.
Это основано на ряде факторов (например, размер полной версии, размер суммы дельт, общее количество дельт между текущей и целевой версией).

## Релизы на GitHub

Существует специальная поддержка выпусков GitHub в «UpdateManager», который будет искать доступные изменения в ряде предыдущих выпусков GitHub. 
Это означает, что любой выпуск GitHub должен содержать только 1 полный пакет и 1 дельта-обновление, чтобы обеспечить правильное обновление. 

## Отключение дельты

Если по какой-то причине вы не хотите использовать дельты, вы можете отключить их с помощью аргумента `--delta none`.
