# Обзор Windows

<AppliesTo win />
Примечания для Windows о создании и использовании пакетов Velopack.

Для Windows Velopack создает и устанавливает структуру папок, которая выглядит следующим образом:

```
%LocalAppData%
└── {packId}
    ├── текущий
    │ ├── YourFile.dll
    │ ├── sq. версия
    │ └── YourApp.exe
    └── Update.exe
```

## Упаковка

Для упаковки программы для Windows не существует особых требований, хотя вы можете настроить установщик 
, используя `--packTitle`, `--splashImage`, `--icon` и т. д. Полный список параметров см. в справке по командной строке.

Также настоятельно рекомендуется (но не обязательно) использовать [кодовый знак](../signing.mdx) перед отправкой пользователям. Если вы этого не сделаете,
ваше приложение может быть помечено как вирус.

## Обновление

Во время обновлений весь `текущий` каталог будет заменен, поэтому, если вам нужно сохранить настройки, журналы, отчеты о сбоях и т. д., 
см. [Сохранение файлов]\(../../integrating/ сохраненные-файлы.mdx).

В Windows, если какой-либо файл внутри `current` используется, папку нельзя переместить/переименовать/удалить и т. д. 
Существует множество вещей, которые могут заблокировать эту папку. Например:

- Процесс, работающий внутри `current`
- Процесс, работающий вне текущего, который открыл файл внутри текущего для чтения. 
- Антивирус/Защитник Windows и т. д.
- Процесс с CWD (текущий рабочий каталог) внутри этой папки (например, процесс cmd.exe).

Если папку невозможно переименовать в процессе обновления, программа обновления Velopack попытается автоматически завершить все процессы, запущенные внутри «current».
Если папка все еще заблокирована и не может быть переименована, программа обновления выполнит поиск других процессов в системе, которые могут блокировать папку - 
, и если таковые будут найдены, она откроет пользователю диалоговое окно с предложением убейте их или прервите обновление. Если процесс блокировки не может быть идентифицирован,
(например, если процесс блокировки выполняется от имени администратора), то пользователю будет показано сообщение об ошибке и старая версия приложения
будет запущен.

:::info
В настоящее время ни программа обновления, ни программа установки не поддерживают привилегированные каталоги, такие как `C:\Program Files`, но поддержка этого планируется в будущем.
:::

## Установка

Установка, созданная Velopack, представляет собой установщик одним щелчком мыши, который покажет заставку по вашему выбору (PNG, JPG или анимированный GIF), 
или, если вы не предоставите изображение, это будет простой прогресс. бар. 

По умолчанию установщик выполняет установку в `%LocalAppData%\{packId}`, но это можно переопределить во время выполнения с помощью аргумента `Setup.exe --installto {dir}`.

Перед началом установки установщик проверит, что [App RID](../rid.mdx) совместим с текущей операционной системой,
, а также проверит наличие отсутствующих [зависимостей начальной загрузки]\(../bootstrapping .mdx).

Кроме того, во время установки установщик запустит [App Hooks](../../integrating/hooks.mdx), а также запустит приложение в первый раз 
после завершения установки. Если вы хотите запретить запуск приложения после завершения установки,
вы можете сделать это с помощью аргумента `Setup.exe --silent`.
